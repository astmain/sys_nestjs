//  prisma使用规范
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite" //  使用sqlite时无法用JSON{},只能使用JSON[]
  url      = "file:./sqlite.db" //  E:/AAA/dayu_sys/dayu_sys02/demo5/make_orm_prisma/sqlite.db

  // provider = "postgresql"
  // url      = env("VITE_url_db_pg")
}

// 测试表
model tb_test {
  id   Int    @id @default(autoincrement())
  name String
  age  Int
}

// 模型商品表
model tb_model_good {
  id              Int      @id @default(autoincrement())
  model_id        String
  title           String
  description     String
  author_name     String
  author_id       String
  count_collect   Int      @default(0)
  count_download  Int      @default(0)
  price_30        Float
  price_all       Float
  is_deleted      Boolean  @default(false)
  is_published    Boolean  @default(false)
  is_check        Boolean  @default(false)
  is_check_remark String?
  category_id     Int?     // 关联分类ID
  created_at      DateTime @default(now())
  updated_at      DateTime @updatedAt

  // 关联关系
  category        tb_model_kind? @relation(fields: [category_id], references: [id])
}

// 模型订单表
model tb_model_order {
  id             Int      @id @default(autoincrement())
  model_order_id String
  status         String
  created_at     DateTime @default(now())
  updated_at     DateTime @updatedAt
}

// 模型分类表
model tb_model_kind {
  id              Int      @id @default(autoincrement())
  name            String
  parent_id       Int?
  level           Int
  category_type   String   // free, paid
  category_style  String?  // simple, modern, industrial
  category_format String?  // stl, obj, igs
  category_kind   String?  // person, car, plane, furniture
  furniture_type  String?  // chair, bed, table, cabinet
  created_at      DateTime @default(now())
  updated_at      DateTime @updatedAt

  // 关联关系
  parent          tb_model_kind?  @relation("CategoryHierarchy", fields: [parent_id], references: [id])
  children        tb_model_kind[] @relation("CategoryHierarchy")
  
  // 与商品表的关联
  goods           tb_model_good[]
}
